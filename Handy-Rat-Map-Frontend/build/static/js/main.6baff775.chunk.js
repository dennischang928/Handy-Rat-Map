(this.webpackJsonpcompetition_2020=this.webpackJsonpcompetition_2020||[]).push([[0],{60:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var c=a(1),s=a.n(c),l=a(23),n=a.n(l),i=a(4),r=a.n(i),o=r.a.create({baseURL:"https://dennis.kinchang.com/api/"});var d=r.a.create({baseURL:"https://maps.googleapis.com/maps/api/geocode/json",params:{language:"zh-HK",key:"AIzaSyDp5-nhlP6MAeUB_Fn1hlr0PMy5OA7i06U"}}),m=r.a.create({baseURL:"https://dennis.kinchang.com/api/"}),u=a(6),j=a.n(u);class b extends j.a.Marker{onClick(e){return this._handleClick=e,this}_onMapClick(e){const t=e.originalEvent.target,a=this._element;this._handleClick&&(t===a||a.contains(t))&&this._handleClick()}}var h=a(0);var g=({OnCenterChange:e,Lat:t,Lng:a,Markers:s,OnMarkerClick:l})=>{const[n,i]=Object(c.useState)(document.documentElement.clientWidth),[r,o]=Object(c.useState)(document.documentElement.clientHeight),[d,m]=Object(c.useState)([]),u=Object(c.useRef)(),g=Object(c.useRef)(null);return Object(c.useEffect)((()=>{const e=()=>{i(window.outerWidth),o(window.outerHeight)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}})),Object(c.useEffect)((()=>{j.a.accessToken="pk.eyJ1IjoiZGVubmlzY2hhbmc5MjgiLCJhIjoiY2tzanRjanRiMXpsbDJvbnVxdTgxNHh4byJ9.AcPK9uy9CBN1DUX8g6G-_Q",u.current=new j.a.Map({container:g.current,style:"mapbox://styles/mapbox/streets-v11",zoom:18}),u.current.setCenter([a,t]),u.current.on("move",(()=>{e(u.current.getCenter().lat,u.current.getCenter().lng)}))}),[]),Object(c.useEffect)((()=>{console.log("Markers update"),s!==[]&&d!==[]&&(d.forEach((e=>{e.remove()})),m(s.map((e=>new b({color:"#FF0000",anchor:"bottom",draggable:!1}).setLngLat([e.Lng,e.Lat]).addTo(u.current).onClick((()=>{l(e)}))))))}),[s]),Object(h.jsx)("div",{children:Object(h.jsx)("div",{style:{height:r,Width:n},ref:g,className:"map-container"})})};var p,O,v,x,f,S,y=({message:e})=>Object(h.jsx)("div",{className:"ui active dimmer",children:Object(h.jsx)("div",{className:"ui text loader",children:e})});function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(e[c]=a[c])}return e}).apply(this,arguments)}function C({title:e,titleId:t,...a},s){return c.createElement("svg",w({id:"bold",enableBackground:"new 0 0 24 24",height:512,viewBox:"0 0 24 24",width:512,xmlns:"http://www.w3.org/2000/svg",ref:s,"aria-labelledby":t},a),e?c.createElement("title",{id:t},e):null,p||(p=c.createElement("path",{d:"m12 22.25c-5.652 0-10.25-4.598-10.25-10.25s4.598-10.25 10.25-10.25 10.25 4.598 10.25 10.25-4.598 10.25-10.25 10.25zm0-18.5c-4.549 0-8.25 3.701-8.25 8.25s3.701 8.25 8.25 8.25 8.25-3.701 8.25-8.25-3.701-8.25-8.25-8.25z"})),O||(O=c.createElement("path",{d:"m12 5.5c-.552 0-1-.448-1-1v-3.5c0-.552.448-1 1-1s1 .448 1 1v3.5c0 .552-.448 1-1 1z"})),v||(v=c.createElement("path",{d:"m23 13h-3.5c-.552 0-1-.448-1-1s.448-1 1-1h3.5c.552 0 1 .448 1 1s-.448 1-1 1z"})),x||(x=c.createElement("path",{d:"m12 24c-.552 0-1-.448-1-1v-3.5c0-.552.448-1 1-1s1 .448 1 1v3.5c0 .552-.448 1-1 1z"})),f||(f=c.createElement("path",{d:"m4.5 13h-3.5c-.552 0-1-.448-1-1s.448-1 1-1h3.5c.552 0 1 .448 1 1s-.448 1-1 1z"})),S||(S=c.createElement("path",{d:"m12 15c-1.654 0-3-1.346-3-3s1.346-3 3-3 3 1.346 3 3-1.346 3-3 3zm0-4c-.551 0-1 .449-1 1s.449 1 1 1 1-.449 1-1-.449-1-1-1z"})))}const N=c.forwardRef(C);a.p;var E,k,L,I,R,z,T,M,A,B,_,D,H,P,U,$,F,J=()=>Object(h.jsx)("div",{style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%) scale(0.07)"},children:Object(h.jsx)(N,{})});function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(e[c]=a[c])}return e}).apply(this,arguments)}function W({title:e,titleId:t,...a},s){return c.createElement("svg",V({id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},xmlSpace:"preserve",ref:s,"aria-labelledby":t},a),e?c.createElement("title",{id:t},e):null,E||(E=c.createElement("g",null,c.createElement("g",null,c.createElement("path",{d:"M256,0C114.833,0,0,114.833,0,256s114.833,256,256,256s256-114.853,256-256S397.167,0,256,0z M256,472.341 c-119.275,0-216.341-97.046-216.341-216.341S136.725,39.659,256,39.659S472.341,136.705,472.341,256S375.295,472.341,256,472.341z "})))),k||(k=c.createElement("g",null,c.createElement("g",null,c.createElement("path",{d:"M355.148,234.386H275.83v-79.318c0-10.946-8.864-19.83-19.83-19.83s-19.83,8.884-19.83,19.83v79.318h-79.318 c-10.966,0-19.83,8.884-19.83,19.83s8.864,19.83,19.83,19.83h79.318v79.318c0,10.946,8.864,19.83,19.83,19.83 s19.83-8.884,19.83-19.83v-79.318h79.318c10.966,0,19.83-8.884,19.83-19.83S366.114,234.386,355.148,234.386z"})))),L||(L=c.createElement("g",null)),I||(I=c.createElement("g",null)),R||(R=c.createElement("g",null)),z||(z=c.createElement("g",null)),T||(T=c.createElement("g",null)),M||(M=c.createElement("g",null)),A||(A=c.createElement("g",null)),B||(B=c.createElement("g",null)),_||(_=c.createElement("g",null)),D||(D=c.createElement("g",null)),H||(H=c.createElement("g",null)),P||(P=c.createElement("g",null)),U||(U=c.createElement("g",null)),$||($=c.createElement("g",null)),F||(F=c.createElement("g",null)))}const q=c.forwardRef(W);a.p;var K=({OnClick:e})=>Object(h.jsx)("div",{children:Object(h.jsx)(q,{style:{position:"fixed",left:"50%",top:"90%",transform:"translate(-50%, -50%) scale(0.15)",fill:"black"},onClick:e})});var G=({ImageSrc:e,OnClick:t})=>{let a=0;if(null===e||void 0===e)return Object(h.jsx)("div",{});const c=e.map(((e,t)=>t<=5?Object(h.jsx)("img",{className:"ui small image",src:e},t):(a=Math.ceil(a+1),Object(h.jsx)("div",{}))));return Object(h.jsx)("div",{style:{cursor:"pointer"},onClick:t,className:"ui mini images",children:c})},Q=a(68);a(60);var X=({Visible:e,ImageSrc:t,OnDelete:a,OnClosed:c})=>{const s=t.map(((e,t)=>Object(h.jsxs)("div",{style:{gridAutoColumns:"auto",gridAutoRows:"auto"},children:[Object(h.jsx)("i",{style:{zIndex:"10000",position:"relative",top:"16%",left:"88%"},className:"close icon",onClick:()=>{a(t)}}),Object(h.jsx)("img",{className:"ui fluid image",src:e},t)]},t)));return Object(h.jsx)(Q.a,{visible:e,animation:"scale",duration:500,children:Object(h.jsxs)("div",{className:"ui segment",style:{zIndex:"2",position:"fixed",top:"5%",bottom:"5%",left:"5%",right:"5%"},children:[Object(h.jsx)("div",{className:"image-list",children:s}),Object(h.jsxs)("button",{style:{position:"absolute",right:"2.5%",bottom:"2.5%"},class:"ui icon button",onClick:c,children:[Object(h.jsx)("i",{class:"edit icon"}),"Finish Edit"]})]})})};var Y=({Value:e,onChange:t,OnImageDelete:a})=>{const[s,l]=Object(c.useState)(!1);return Object(h.jsxs)("div",{className:"two column row",children:[Object(h.jsx)("div",{className:"eight wide column",children:Object(h.jsx)(G,{OnClick:()=>{l(!0)},ImageSrc:e})}),Object(h.jsx)("div",{className:"eight wide column",children:Object(h.jsxs)("label",{for:"fileSelector",className:"fluid ui small button",children:[Object(h.jsx)("input",{type:"file",id:"fileSelector",className:"fileSelector","data-target":"file-uploader",accept:"image/*",multiple:!0,onChange:()=>{const a=document.getElementById("fileSelector").files;let c=e;for(let e=0;e<a.length;e++){const t=new FileReader;t.readAsDataURL(a[e]),t.onload=function(){c.push(t.result)}}t(c)}}),Object(h.jsx)("i",{className:"fluid images icon"}),"Add Images"]})}),Object(h.jsx)(X,{OnClosed:()=>{l(!1)},OnDelete:a,Visible:s,ImageSrc:e})]})},Z=a(11),ee=a.p+"static/media/CreateSuccessSoundEffect.360479bd.mp3",te=a.p+"static/media/CreateFailSoundEffect.537c3319.mp3";var ae=({visible:e,CompanyCreateState:t,message:a,OnClosed:s,OnSumbit:l,Lat:n,Lng:i,Address:r})=>{const o=[{value:"BAR",name:"Bar"},{value:"RESTR",name:"Restaurant"},{value:"SMKT",name:"Supermarket"},{value:"BTQ",name:"Boutique"},{value:"SCH",name:"School"}],[d,m]=Object(c.useState)([]),[u,j]=Object(c.useState)(""),[b,g]=Object(c.useState)(o[0].value),[p,O]=Object(c.useState)(),[v]=Object(Z.a)(ee),[x]=Object(Z.a)(te);Object(c.useEffect)((()=>{2===t?v():3===t&&x()}),[t]);const f=o.map((e=>Object(h.jsx)("option",{value:e.value,children:e.name})));return Object(h.jsx)(Q.a,{visible:e,animation:"fade up",duration:700,children:Object(h.jsx)("div",{style:{position:"fixed",bottom:"0%",width:"100%"},children:Object(h.jsxs)("div",{className:"ui segment",children:[Object(h.jsxs)("div",{className:`ui ${2===t?"active":"inactive"} inverted dimmer`,children:[Object(h.jsx)("i",{className:"big check icon"}),`${u} is created!`]}),Object(h.jsxs)("div",{className:`ui ${3===t?"active":"inactive"} dimmer`,children:[Object(h.jsx)("i",{className:"inverted big exclamation triangle icon"}),Object(h.jsx)("div",{style:{color:"white"},children:`Create "${u}" fail.`}),Object(h.jsx)("n",{}),Object(h.jsx)("div",{style:{color:"red"},children:a})]}),Object(h.jsx)("i",{onClick:s,style:{position:"absolute",right:"50%",transform:"translate(+50%, -50%) scale(1.3)"},className:"caret down icon"}),Object(h.jsx)("br",{}),Object(h.jsx)("div",{className:"ui form",children:Object(h.jsxs)("div",{className:"ui grid",children:[Object(h.jsxs)("div",{className:"two column row",children:[Object(h.jsx)("div",{className:"column",children:Object(h.jsxs)("div",{className:"field",children:[Object(h.jsx)("label",{children:"Shop name"}),Object(h.jsx)("input",{type:"text",name:"SHOP-NAME",placeholder:"e.g., Ray's Bar",value:u,onChange:e=>{j(e.target.value)}})]})}),Object(h.jsx)("div",{className:"column",children:Object(h.jsxs)("div",{className:"field",children:[Object(h.jsx)("label",{children:"Shop Type"}),Object(h.jsx)("select",{className:"ui fluid dropdown",onChange:e=>{g(e.target.value)},value:b,children:f})]})})]}),Object(h.jsx)(Y,{Value:d,onChange:e=>{m(e)},OnImageDelete:e=>{m(d.filter(((t,a)=>a!=e)))}}),Object(h.jsxs)("div",{className:"two column row",children:[Object(h.jsx)("div",{className:"fourteen wide column",children:Object(h.jsxs)("div",{className:"field",children:[Object(h.jsx)("label",{children:"Description"}),Object(h.jsx)("textarea",{rows:"1",value:p,onChange:e=>{O(e.target.value)}})]})}),Object(h.jsx)("div",{className:"two wide column",children:Object(h.jsx)("i",{onClick:()=>{console.log(typeof r),l({ShopName:u,ShopType:b,ImageSrc:d,ShopDescription:p,Addr:r,Lat:n,Lng:i})},className:0===t?"paper plane outline icon":"",style:{transform:"scale(2)",position:"absolute",bottom:"35%",left:"25%"},children:Object(h.jsx)("div",{style:{zIndex:10},className:`ui mini ${1===t?"active":" inactive"} inline loader`,children:" "})})})]})]})})]})})})};var ce=({ImageSrc:e,LoaderEnable:t})=>{const[a,s]=Object(c.useState)(0);Object(c.useEffect)((()=>{s(0)}),[t]);return Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"two wide column",children:Object(h.jsx)("i",{onClick:()=>{0!==a&&s(a-1)},style:{position:"absolute",left:"50%",bottom:"50%",transform:"Scale(2)",cursor:"pointer"},className:"caret square left icon"})}),Object(h.jsx)("div",{className:"twelve wide column",children:(console.log(e),!0===t?Object(h.jsx)("img",{style:{display:"block",marginLeft:"auto",marginRight:"auto",Width:"auto",height:"auto"},src:0!==e.length?e[a]:"https://www.wddonline.com/content/uploads/2020/08/placeholder-image.png"}):Object(h.jsxs)("div",{id:"Image",className:"ui segment",style:{display:"block",maxWidth:"auto",Width:"auto",height:"200px"},children:[Object(h.jsx)("div",{className:"ui active inverted dimmer",children:Object(h.jsx)("div",{className:"ui text loader",children:"Loading"})}),Object(h.jsx)("p",{})]}))}),Object(h.jsx)("div",{className:"two wide column",children:Object(h.jsx)("i",{onClick:()=>{a!==e.length-1&&s(a+1)},style:{position:"absolute",right:"50%",bottom:"50%",transform:"Scale(2)",cursor:"pointer"},className:"caret square right icon"})})]})};var se=({Company:e,State:t,onClosed:a})=>{const s=[{value:"BAR",name:"Bar"},{value:"RESTR",name:"Restaurant"},{value:"SMKT",name:"Supermarket"},{value:"BTQ",name:"Boutique"},{value:"SCH",name:"School"}],[l,n]=Object(c.useState)();return Object(c.useEffect)((()=>{const t=s.filter((t=>t.value===e.ShopType))[0];t&&n(t.name)}),[e]),console.log(e.ImageSrc),Object(h.jsx)(Q.a,{visible:0!==t,animation:"scale",duration:500,children:Object(h.jsxs)("div",{className:"ui segment",style:{zIndex:"2",position:"fixed",top:"5%",bottom:"5%",left:"5%",right:"5%"},children:[Object(h.jsxs)("button",{className:"ui grey small labeled icon button",onClick:a,children:[Object(h.jsx)("i",{className:"reply icon"}),"Back"]}),Object(h.jsxs)("div",{className:"ui grey large label",style:{position:"absolute",right:"10px"},children:[Object(h.jsx)("i",{className:"home icon"})," ",l]}),Object(h.jsx)("h6",{children:" "}),Object(h.jsxs)("div",{style:{grid:"10px"},className:"ui grid",children:[Object(h.jsx)(ce,{ImageSrc:e.ImageSrc,LoaderEnable:2===t}),Object(h.jsx)("div",{className:"row",children:Object(h.jsxs)("div",{className:"column",children:[Object(h.jsx)("h2",{children:e.ShopName}),Object(h.jsx)("br",{}),e.ShopDescription,Object(h.jsx)("h2",{}),Object(h.jsx)("p",{style:{color:"blue"},children:e.Addr})]})})]})]})})};var le=()=>{const[e,t]=Object(c.useState)(null),[a,s]=Object(c.useState)(null),[l,n]=Object(c.useState)(""),[i,r]=Object(c.useState)(!1),[u,j]=Object(c.useState)(0),[b,p]=Object(c.useState)(null),[O,v]=Object(c.useState)([]),[x,f]=Object(c.useState)(null),[S,w]=Object(c.useState)(0),[C,N]=Object(c.useState)({Lat:null,Lng:null,ShopName:null,ShopType:null,ShopDescription:null,Addr:null,_id:null,ImageSrc:[]}),E=async()=>{const t=await m.get("/Company/SurroundingCompany",{params:{Lng:e,Lat:a}});console.log("Response"),O.length!==t.data.length&&v(t.data)};Object(c.useEffect)((()=>{if(!0===i){j(1);const t=setTimeout((()=>{R(a,e),j(0)}),800);return()=>{clearTimeout(t)}}}),[a,e,i]),Object(c.useEffect)((()=>{const e=setTimeout(E,200);return()=>{clearTimeout(e)}}),[a,e]),Object(c.useEffect)(E,[]),Object(c.useEffect)((()=>{k()}),[]);const k=()=>{window.navigator.geolocation.getCurrentPosition((e=>{t(e.coords.longitude),s(e.coords.latitude)}),(e=>{f(e.message)}))},L=(e,a)=>{t(a),s(e)},I=async e=>{j(1);try{await o.post("/Company/CreateCompany",e);j(2)}catch(t){j(3),p(t.message)}setTimeout((()=>{E(),j(0),r(!1),console.log("closed")}),2e3)},R=async(e,t)=>{const a=await d.get("",{params:{latlng:`${e},${t}`}});console.log(a.data.results[0].formatted_address.toString()),n(a.data.results[0].formatted_address.toString())},z=()=>{r(!0)},T=async e=>{let t={Lat:null,Lng:null,ShopName:null,ShopType:null,ShopDescription:null,Addr:null,_id:null,ImageSrc:[]};t.Lat=e.Lat,t.Lng=e.Lng,t.ShopName=e.ShopName,t.ShopType=e.ShopType,t.ShopDescription=e.ShopDescription,t.Addr=e.Addr,t._id=e._id,w(1),N(t);const a=await m.get("/Company/GetCompanyImage",{params:{id:e._id}});t.ImageSrc=a.data.ImageSrc,w(2),N(t)};return null!==e&&null!==a?Object(h.jsxs)("div",{children:[Object(h.jsx)(se,{Company:C,State:S,onClosed:()=>{w(0)}}),Object(h.jsx)(g,{Lat:a,Lng:e,OnCenterChange:L,Markers:O,OnMarkerClick:T}),Object(h.jsx)(J,{}),Object(h.jsx)(K,{OnClick:z}),Object(h.jsx)(ae,{CompanyCreateState:u,Address:l,Lat:a,Lng:e,visible:i,OnSumbit:I,OnClosed:()=>{r(!1)},message:b})]}):Object(h.jsx)(y,{message:x})};a(63),a(64);n.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(le,{})}),document.querySelector("#root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.6baff775.chunk.js.map